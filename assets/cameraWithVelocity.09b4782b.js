import{n as j,s as l0,g as x0}from"./index.43060684.js";const D=(t,e)=>(console.error(t,e),new Error(t)),A0=(t,e,r)=>{const o=t.createShader(e);if(!o)throw D("error creating shader",{shader:o});if(t.shaderSource(o,r),t.compileShader(o),t.getShaderParameter(o,t.COMPILE_STATUS))return o;const c=t.getShaderInfoLog(o)||"Failed to create shader";throw t.deleteShader(o),new Error(c)},L0=(t,e,r)=>{const o=t.createProgram();if(!o)throw D("error creating program",{program:o});if(t.attachShader(o,e),t.attachShader(o,r),t.linkProgram(o),t.getProgramParameter(o,t.LINK_STATUS))return o;const c=t.getProgramInfoLog(o)||"Failed to create program";throw t.deleteProgram(o),new Error(c)},k0=t=>{const e=t.clientWidth,r=t.clientHeight,o=t.width!==e||t.height!==r;return o&&(t.width=e,t.height=r),o},q=t=>t*Math.PI/180,u0=(t,e)=>t[0]*e[0]+t[1]*e[1]+t[2]*e[2],H=(t,e)=>[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]],v0=(t,e)=>[t[0]-e[0],t[1]-e[1],t[2]-e[2]],s0=(t,e)=>[t[0]+e[0],t[1]+e[1],t[2]+e[2]],X=(t,e)=>[t[0]*e,t[1]*e,t[2]*e],O=t=>{const e=Math.sqrt(t[0]**2+t[1]**2+t[2]**2);return e>1e-5?[t[0]/e,t[1]/e,t[2]/e]:[0,0,0]},m={createProjectionMatrix:function(t,e,r){return[2/t,0,0,0,0,-2/e,0,0,0,0,2/r,0,-1,1,0,1]},createIdentityMatrix:()=>[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],createTranslationMatrix:(t,e,r)=>[1,0,0,0,0,1,0,0,0,0,1,0,t,e,r,1],createXRotationMatrix:t=>{const e=Math.cos(t),r=Math.sin(t);return[1,0,0,0,0,e,r,0,0,-r,e,0,0,0,0,1]},createYRotationMatrix:t=>{const e=Math.cos(t),r=Math.sin(t);return[e,0,-r,0,0,1,0,0,r,0,e,0,0,0,0,1]},createZRotationMatrix:t=>{const e=Math.cos(t),r=Math.sin(t);return[e,r,0,0,-r,e,0,0,0,0,1,0,0,0,0,1]},createScalingMatrix:function(t,e,r){return[t,0,0,0,0,e,0,0,0,0,r,0,0,0,0,1]},createPerspectiveMatrix(t,e,r,o){const s=Math.tan(Math.PI*.5-.5*t),c=1/(r-o);return[s/e,0,0,0,0,s,0,0,0,0,(r+o)*c,-1,0,0,r*o*c*2,0]},createLookAtMatrix:(t,e,r)=>{var o=O(v0(t,e)),s=O(H(r,o)),c=O(H(o,s));return[s[0],s[1],s[2],0,c[0],c[1],c[2],0,o[0],o[1],o[2],0,t[0],t[1],t[2],1]},_lookAt:(t,e,r)=>{var o=O(v0(t,e)),s=O(H(r,o)),c=O(H(o,s));return[s[0],s[1],s[2],0,c[0],c[1],c[2],0,o[0],o[1],o[2],0,-u0(s,t),-u0(c,t),-u0(o,t),1]},__lookAt:(t,e)=>{const o=O(H([0,1,0],e)),s=H(e,o);return m.multiply([o[0],o[1],o[2],0,s[0],s[1],s[2],0,e[0],e[1],e[2],0,0,0,0,1],[1,0,0,-t[0],0,1,0,-t[1],0,0,1,-t[2],0,0,0,1])},multiply:function(t,e){const r=4,o=e[0*r+0],s=e[0*r+1],c=e[0*r+2],a=e[0*r+3],h=e[1*r+0],d=e[1*r+1],p=e[1*r+2],u=e[1*r+3],M=e[2*r+0],x=e[2*r+1],A=e[2*r+2],_=e[2*r+3],v=e[3*r+0],w=e[3*r+1],g=e[3*r+2],S=e[3*r+3],E=t[0*r+0],y=t[0*r+1],R=t[0*r+2],T=t[0*r+3],b=t[1*r+0],I=t[1*r+1],L=t[1*r+2],k=t[1*r+3],F=t[2*r+0],P=t[2*r+1],V=t[2*r+2],B=t[2*r+3],U=t[3*r+0],C=t[3*r+1],Y=t[3*r+2],z=t[3*r+3];return[o*E+s*b+c*F+a*U,o*y+s*I+c*P+a*C,o*R+s*L+c*V+a*Y,o*T+s*k+c*B+a*z,h*E+d*b+p*F+u*U,h*y+d*I+p*P+u*C,h*R+d*L+p*V+u*Y,h*T+d*k+p*B+u*z,M*E+x*b+A*F+_*U,M*y+x*I+A*P+_*C,M*R+x*L+A*V+_*Y,M*T+x*k+A*B+_*z,v*E+w*b+g*F+S*U,v*y+w*I+g*P+S*C,v*R+w*L+g*V+S*Y,v*T+w*k+g*B+S*z]},translate:(t,e,r,o)=>m.multiply(t,m.createTranslationMatrix(e,r,o)),scale:(t,e,r,o)=>m.multiply(t,m.createScalingMatrix(e,r,o)),rotateX:(t,e)=>m.multiply(t,m.createXRotationMatrix(e)),rotateY:(t,e)=>m.multiply(t,m.createYRotationMatrix(e)),rotateZ:(t,e)=>m.multiply(t,m.createZRotationMatrix(e)),inverse:t=>{const e=4,r=t[0*e+0],o=t[0*e+1],s=t[0*e+2],c=t[0*e+3],a=t[1*e+0],h=t[1*e+1],d=t[1*e+2],p=t[1*e+3],u=t[2*e+0],M=t[2*e+1],x=t[2*e+2],A=t[2*e+3],_=t[3*e+0],v=t[3*e+1],w=t[3*e+2],g=t[3*e+3],S=x*g,E=w*A,y=d*g,R=w*p,T=d*A,b=x*p,I=s*g,L=w*c,k=s*A,F=x*c,P=s*p,V=d*c,B=u*v,U=_*M,C=a*v,Y=_*h,z=a*M,J=u*h,Q=r*v,t0=_*o,e0=r*M,r0=u*o,o0=r*h,n0=a*o,p0=S*h+R*M+T*v-(E*h+y*M+b*v),f0=E*o+I*M+F*v-(S*o+L*M+k*v),_0=y*o+L*h+P*v-(R*o+I*h+V*v),M0=b*o+k*h+V*M-(T*o+F*h+P*M),f=1/(r*p0+a*f0+u*_0+_*M0);return[f*p0,f*f0,f*_0,f*M0,f*(E*a+y*u+b*_-(S*a+R*u+T*_)),f*(S*r+L*u+k*_-(E*r+I*u+F*_)),f*(R*r+I*a+V*_-(y*r+L*a+P*_)),f*(T*r+F*a+P*u-(b*r+k*a+V*u)),f*(B*p+Y*A+z*g-(U*p+C*A+J*g)),f*(U*c+Q*A+r0*g-(B*c+t0*A+e0*g)),f*(C*c+t0*p+o0*g-(Y*c+Q*p+n0*g)),f*(J*c+e0*p+n0*A-(z*c+r0*p+o0*A)),f*(C*x+J*w+U*d-(z*w+B*d+Y*x)),f*(e0*w+B*s+t0*x-(Q*x+r0*w+U*s)),f*(Q*d+n0*w+Y*s-(o0*w+C*s+t0*d)),f*(o0*x+z*s+r0*d-(e0*d+n0*x+J*s))]}},w0=(t,e,r)=>Math.max(t,Math.min(e,r)),g0=[0,0,0,0,.5,0,.1,0,0,0,.5,0,.1,.5,0,.1,0,0,.1,0,0,.1,.1,0,.33,0,0,.1,.1,0,.33,.1,0,.33,0,0,.1,.2,0,.1,.3,0,.25,.2,0,.1,.3,0,.25,.3,0,.25,.2,0,0,0,.1,.1,0,.1,0,.5,.1,0,.5,.1,.1,0,.1,.1,.5,.1,.1,0,.1,.33,0,.1,.1,.1,.1,.1,.1,.1,.33,0,.1,.33,.1,.1,.1,.2,.1,.25,.2,.1,.1,.3,.1,.1,.3,.1,.25,.2,.1,.25,.3,.1,0,0,0,.33,0,0,.33,0,.1,0,0,0,.33,0,.1,0,0,.1,.33,0,0,.33,.1,0,.33,.1,.1,.33,0,0,.33,.1,.1,.33,0,.1,.1,.1,0,.1,.1,.1,.33,.1,.1,.1,.1,0,.33,.1,.1,.33,.1,0,.1,.1,0,.1,.2,.1,.1,.1,.1,.1,.1,0,.1,.2,0,.1,.2,.1,.1,.2,0,.25,.2,.1,.1,.2,.1,.1,.2,0,.25,.2,0,.25,.2,.1,.25,.2,0,.25,.3,.1,.25,.2,.1,.25,.2,0,.25,.3,0,.25,.3,.1,.1,.3,0,.1,.3,.1,.25,.3,.1,.1,.3,0,.25,.3,.1,.25,.3,0,.1,.3,0,.1,.5,.1,.1,.3,.1,.1,.3,0,.1,.5,0,.1,.5,.1,0,.5,0,0,.5,.1,.1,.5,.1,0,.5,0,.1,.5,.1,.1,.5,0,0,0,0,0,0,.1,0,.5,.1,0,0,0,0,.5,.1,0,.5,0],F0=[200,70,120,200,70,120,200,70,120,200,70,120,200,70,120,200,70,120,200,70,120,200,70,120,200,70,120,200,70,120,200,70,120,200,70,120,200,70,120,200,70,120,200,70,120,200,70,120,200,70,120,200,70,120,80,70,200,80,70,200,80,70,200,80,70,200,80,70,200,80,70,200,80,70,200,80,70,200,80,70,200,80,70,200,80,70,200,80,70,200,80,70,200,80,70,200,80,70,200,80,70,200,80,70,200,80,70,200,70,200,210,70,200,210,70,200,210,70,200,210,70,200,210,70,200,210,200,200,70,200,200,70,200,200,70,200,200,70,200,200,70,200,200,70,210,100,70,210,100,70,210,100,70,210,100,70,210,100,70,210,100,70,210,160,70,210,160,70,210,160,70,210,160,70,210,160,70,210,160,70,70,180,210,70,180,210,70,180,210,70,180,210,70,180,210,70,180,210,100,70,210,100,70,210,100,70,210,100,70,210,100,70,210,100,70,210,76,210,100,76,210,100,76,210,100,76,210,100,76,210,100,76,210,100,140,210,80,140,210,80,140,210,80,140,210,80,140,210,80,140,210,80,90,130,110,90,130,110,90,130,110,90,130,110,90,130,110,90,130,110,160,160,220,160,160,220,160,160,220,160,160,220,160,160,220,160,160,220];var P0=`attribute vec4 a_position;

attribute vec4 a_color;

varying vec4 v_color;

uniform mat4 u_matrix;

void main() {
  // transform position using matrix transformation
  gl_Position = u_matrix * a_position;

  v_color = a_color;
}`,S0=`precision highp float;

varying vec4 v_color;
 
void main() {
  // Just set the output to a constant reddish-purple
  gl_FragColor = v_color;
}`;const E0=6,y0=.5;let N,n,R0,T0=m.createIdentityMatrix(),c0=q(60),V0=1e-4,B0=100;const i={w:!1,a:!1,s:!1,d:!1,space:!1,shift:!1},b0=120,W=5e-4,m0=.9;let G=0,h0=-90,l=[0,0,0],$=[0,.1,2],Z=[0,0,-1],K=[0,1,0];const U0=async()=>{if(N=document.querySelector("canvas"),!N)throw D("canvas not found",{canvas:N});if(n=N.getContext("webgl"),!n)throw D("WebGL not supported",{gl:n});z0();const t=A0(n,n.VERTEX_SHADER,P0),e=A0(n,n.FRAGMENT_SHADER,S0);console.log({fragmentShaderSource:S0});const r=L0(n,t,e);n.useProgram(r);const o=n.getAttribLocation(r,"a_position"),s=n.getAttribLocation(r,"a_color");R0=n.getUniformLocation(r,"u_matrix");const c=n.createBuffer();if(!c)throw D("error creating position buffer",{positionBuffer:c});n.bindBuffer(n.ARRAY_BUFFER,c),n.enableVertexAttribArray(o),n.vertexAttribPointer(o,3,n.FLOAT,!1,0,0),n.bufferData(n.ARRAY_BUFFER,new Float32Array(g0),n.STATIC_DRAW);const a=n.createBuffer();if(!a)throw D("error creating position buffer",{colorBuffer:a});n.bindBuffer(n.ARRAY_BUFFER,a),n.enableVertexAttribArray(s),n.vertexAttribPointer(s,3,n.UNSIGNED_BYTE,!0,0,0),n.bufferData(n.ARRAY_BUFFER,new Uint8ClampedArray(F0),n.STATIC_DRAW),d0(),a0(),requestAnimationFrame(I0)},C0=t=>{$[0]+=l[0]*t,$[1]+=l[1]*t,$[2]+=l[2]*t},Y0=()=>{i.w&&(l=s0(l,X(Z,W))),i.a&&(l=l0(l,X(j(x0(Z,K)),W))),i.s&&(l=l0(l,X(Z,W))),i.d&&(l=s0(l,X(j(x0(Z,K)),W))),i.space&&(l=s0(l,X(j(K),W))),i.shift&&(l=l0(l,X(j(K),W))),l[0]*=m0,l[1]*=m0,l[2]*=m0},d0=(t=0,e=0)=>{h0+=t*b0,G+=e*b0,G=w0(-89,G,89);let r=[0,0,0];r[0]=Math.cos(q(h0))*Math.cos(q(G)),r[1]=Math.sin(q(G)),r[2]=Math.sin(q(h0))*Math.cos(q(G)),Z=j(r)},a0=()=>{const t=m.createPerspectiveMatrix(c0,n.canvas.clientWidth/n.canvas.clientHeight,V0,B0),e=s0($,Z),r=m.createLookAtMatrix($,e,K),o=m.inverse(r);T0=m.multiply(t,o)};let i0=null;const I0=t=>{i0===null&&(i0=t);const e=t-i0;i0=t,C0(e),Y0(),d0(),a0(),k0(n.canvas),n.viewport(0,0,n.canvas.width,n.canvas.height),n.clearColor(0,0,0,0),n.clear(n.COLOR_BUFFER_BIT|n.DEPTH_BUFFER_BIT),n.enable(n.CULL_FACE),n.enable(n.DEPTH_TEST);for(let r=0;r<E0;r++){const s=r/E0*Math.PI*2,c=Math.cos(s)*y0,a=Math.sin(s)*y0,h=m.translate(T0,c,0,a);n.uniformMatrix4fv(R0,!1,h);const d=n.TRIANGLES,p=0,u=g0.length/3;n.drawArrays(d,p,u)}requestAnimationFrame(I0)},z0=()=>{window.addEventListener("resize",()=>{a0()}),window.addEventListener("keydown",e=>{switch(e.key){case"w":i.w=!0;break;case"a":i.a=!0;break;case"s":i.s=!0;break;case"d":i.d=!0;break;case" ":i.space=!0;break;case"Shift":i.shift=!0;break}}),window.addEventListener("keyup",e=>{switch(e.key){case"w":i.w=!1;break;case"a":i.a=!1;break;case"s":i.s=!1;break;case"d":i.d=!1;break;case" ":i.space=!1;break;case"Shift":i.shift=!1;break}}),document.querySelector("#enable").addEventListener("click",()=>{N.requestPointerLock()}),document.addEventListener("pointerlockchange",()=>{const e=document.querySelector("#backdrop");document.pointerLockElement===N?e.classList.add("hide"):e.classList.remove("hide")}),N.onmousemove=e=>{const{width:r,height:o}=N.getBoundingClientRect(),s=e.movementX/r,c=-e.movementY/o;d0(s,c),a0()},window.onwheel=e=>{c0+=.01*Math.sign(e.deltaY),c0=w0(Math.PI/16,c0,Math.PI/2)}};U0();
